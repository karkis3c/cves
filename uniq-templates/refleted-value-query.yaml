id: reflected-value-via-query

info:
  name: Check reflected-values in response body.
  author: kaks3c
  severity: low
  description: |
    This template tests for reflected values in query parameters by sending different encoded payloads and matching the responses.
  tags: xss,low,fuzz

http:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0

    payloads:
      payload:
        - bugcrowdresecher111
        - '%62%75%67%63%72%6F%77%64%72%65%73%65%63%68%65%72%32%32%32'
        - YnVnY3Jvd2RyZXNlY2hlcjMzMw==
        - '&#98;&#117;&#103;&#99;&#114;&#111;&#119;&#100;&#114;&#101;&#115;&#101;&#99;&#104;&#101;&#114;&#52;&#52;'

    attack: batteringram

    fuzzing:
      - part: query
        fuzz:
          - "{{payload}}"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - bugcrowdresecher111
          - bugcrowdresecher222
          - bugcrowdresecher333
          - bugcrowdresecher444
        part: body
        condition: or

      - type: word
        words:
          - "Content-type: application/json"
        part: header
        negative: true

    extractors:
      - type: regex
        part: body
        name: plaintext
        regex:
          - "bugcrowdresecher111" #1payload-works

      - type: regex
        part: body
        name: urlencode
        regex:
          - "bugcrowdresecher222" #2payload-works

      - type: regex
        part: body
        name: base64encode
        regex:
          - "bugcrowdresecher333" #3payload-worked

      - type: regex
        part: body
        name: htmlencode
        regex:
          - "bugcrowdresecher444" #4payload-worked

    stop-at-first-match: true
